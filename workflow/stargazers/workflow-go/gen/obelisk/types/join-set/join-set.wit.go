// Code generated by wit-bindgen-go. DO NOT EDIT.

// Package joinset represents the imported interface "obelisk:types/join-set@4.0.0".
package joinset

import (
	"github.com/obeli-sk/demo-stargazers/workflow-go/gen/obelisk/types/execution"
	"github.com/obeli-sk/demo-stargazers/workflow-go/gen/obelisk/types/time"
	"go.bytecodealliance.org/cm"
)

// ScheduleAt represents the type alias "obelisk:types/join-set@4.0.0#schedule-at".
//
// See [time.ScheduleAt] for more information.
type ScheduleAt = time.ScheduleAt

// DelayID represents the type alias "obelisk:types/join-set@4.0.0#delay-id".
//
// See [execution.DelayID] for more information.
type DelayID = execution.DelayID

// ResponseID represents the type alias "obelisk:types/join-set@4.0.0#response-id".
//
// See [execution.ResponseID] for more information.
type ResponseID = execution.ResponseID

// JoinSet represents the imported resource "obelisk:types/join-set@4.0.0#join-set".
//
// Join set resouce.
//
//	resource join-set
type JoinSet cm.Resource

// ResourceDrop represents the imported resource-drop for resource "join-set".
//
// Drops a resource handle.
//
//go:nosplit
func (self JoinSet) ResourceDrop() {
	self0 := cm.Reinterpret[uint32](self)
	wasmimport_JoinSetResourceDrop((uint32)(self0))
	return
}

// ID represents the imported method "id".
//
// Get the join set identifier in the form of:
// * `o:NAME` in case of a one-off join set, where `NAME` is generally an auto-incremented
// index optionally followed by underscode and a supplied name,
// * `g:NAME` in case of a generated join set where `NAME` is generally an auto-incremented
// index,
// * `n:NAME` in case of a named join set
//
//	id: func() -> string
//
//go:nosplit
func (self JoinSet) ID() (result string) {
	self0 := cm.Reinterpret[uint32](self)
	wasmimport_JoinSetID((uint32)(self0), &result)
	return
}

// JoinNext represents the imported method "join-next".
//
// Block the workflow execution until next response associated with the join set arrives.
// The response is marked as processed.
// Child execution result can be obtained using `-get` extension function using the
// returned execution ID.
// Return `join-next-error::all-processed` if the join set has all requests matched
// with responses.
//
//	join-next: func() -> result<tuple<response-id, result>, join-next-error>
//
//go:nosplit
func (self JoinSet) JoinNext() (result cm.Result[TupleResponseIDResultShape, cm.Tuple[ResponseID, cm.BoolResult], JoinNextError]) {
	self0 := cm.Reinterpret[uint32](self)
	wasmimport_JoinSetJoinNext((uint32)(self0), &result)
	return
}

// SubmitDelay represents the imported method "submit-delay".
//
// Submit a delay request to the join set. The delay can be later polled using `join-next`.
//
//	submit-delay: func(timeout: schedule-at) -> delay-id
//
//go:nosplit
func (self JoinSet) SubmitDelay(timeout ScheduleAt) (result DelayID) {
	self0 := cm.Reinterpret[uint32](self)
	timeout0, timeout1, timeout2 := lower_ScheduleAt(timeout)
	wasmimport_JoinSetSubmitDelay((uint32)(self0), (uint32)(timeout0), (uint64)(timeout1), (uint64)(timeout2), &result)
	return
}

// JoinNextError represents the variant "obelisk:types/join-set@4.0.0#join-next-error".
//
// Error variants that may occur when calling `join-next` function.
//
//	variant join-next-error {
//		all-processed,
//	}
type JoinNextError uint8

const (
	// All submitted requests and their responses were already processed.
	JoinNextErrorAllProcessed JoinNextError = iota
)

var _JoinNextErrorStrings = [1]string{
	"all-processed",
}

// String implements [fmt.Stringer], returning the enum case name of e.
func (e JoinNextError) String() string {
	return _JoinNextErrorStrings[e]
}

// MarshalText implements [encoding.TextMarshaler].
func (e JoinNextError) MarshalText() ([]byte, error) {
	return []byte(e.String()), nil
}

// UnmarshalText implements [encoding.TextUnmarshaler], unmarshaling into an enum
// case. Returns an error if the supplied text is not one of the enum cases.
func (e *JoinNextError) UnmarshalText(text []byte) error {
	return _JoinNextErrorUnmarshalCase(e, text)
}

var _JoinNextErrorUnmarshalCase = cm.CaseUnmarshaler[JoinNextError](_JoinNextErrorStrings[:])
